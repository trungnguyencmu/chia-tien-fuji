import{r as n,g as R,e as B,f as $,j as e,h as M,s as g,i as O,k as G,l as H,m as Z}from"./index-BGAbBvya.js";function J(){const[b,y]=n.useState([]),[o,m]=n.useState(null),[p,j]=n.useState(""),[C,v]=n.useState(!1),[h,u]=n.useState([]),[f,N]=n.useState(""),[x,w]=n.useState(""),[T,l]=n.useState(null),[S,a]=n.useState(null),[r,i]=n.useState(!1),[c,A]=n.useState(!1);n.useEffect(()=>{I();const t=R();m(t),t&&k()},[]);const I=async()=>{v(!0);try{const s=(await B()).filter(d=>d.isActive);y(s)}catch{l("Failed to load trips from server")}finally{v(!1)}},z=async t=>{if(t.preventDefault(),l(null),a(null),!p.trim()){l("Trip name cannot be empty");return}i(!0);try{const s=await M(p);y(d=>[...d,s]),j(""),g(s.tripId),m(s.tripId),a(`Created trip "${p}" successfully!`),setTimeout(()=>a(null),3e3)}catch(s){l(s instanceof Error?s.message:"Failed to create trip")}finally{i(!1)}},D=t=>{g(t),m(t),k(),a("Trip selected!"),setTimeout(()=>a(null),2e3)},E=async(t,s)=>{if(window.confirm(`Are you sure you want to delete trip "${s}"?`)){i(!0);try{await O(t),y(d=>d.filter(W=>W.tripId!==t)),t===o&&(g(""),m(null),u([])),a(`Deleted trip "${s}" successfully!`),setTimeout(()=>a(null),3e3)}catch(d){l(d instanceof Error?d.message:"Failed to delete trip")}finally{i(!1)}}},k=async()=>{i(!0);try{const t=await $();u(t)}catch{l("Failed to load payer names from server")}finally{i(!1)}},P=async t=>{if(t.preventDefault(),l(null),a(null),!f.trim()){l("Name cannot be empty");return}i(!0);try{const s=await G(f);u(s),N(""),a(`Added "${f}" successfully!`),setTimeout(()=>a(null),3e3)}catch(s){l(s instanceof Error?s.message:"Failed to add name")}finally{i(!1)}},F=async t=>{if(window.confirm(`Are you sure you want to remove "${t}"?`)){i(!0);try{const s=await H(t);u(s),a(`Removed "${t}" successfully!`),setTimeout(()=>a(null),3e3)}catch(s){l(s instanceof Error?s.message:"Failed to remove name")}finally{i(!1)}}},L=async t=>{if(t.preventDefault(),l(null),a(null),!o){l("No trip selected");return}if(!x){l("Please enter the password");return}if(window.confirm("‚ö†Ô∏è WARNING: This will permanently delete ALL expenses in this trip! Are you absolutely sure?")){A(!0);try{await Z(o,x),w(""),a("All expenses have been deleted successfully!"),setTimeout(()=>a(null),5e3)}catch(s){l(s instanceof Error?s.message:"Failed to delete expenses")}finally{A(!1)}}};return e.jsxs("div",{children:[S&&e.jsxs("div",{className:"alert",style:{background:"#d1fae5",border:"1px solid #6ee7b7",color:"#065f46",marginBottom:"2rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"‚úÖ"}),e.jsx("div",{style:{flex:1},children:S})]}),T&&e.jsxs("div",{className:"alert alert-error",children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"‚ö†Ô∏è"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("strong",{children:"Error:"})," ",T]})]}),e.jsxs("div",{className:"card",style:{background:"linear-gradient(135deg, rgba(255, 158, 193, 0.1) 0%, rgba(199, 180, 243, 0.1) 100%)"},children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem",fontWeight:"700"},children:"‚úàÔ∏è Trip Management"}),e.jsx("form",{onSubmit:z,style:{marginBottom:"2rem"},children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"newTripName",children:"Create New Trip"}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("input",{id:"newTripName",type:"text",className:"form-input",value:p,onChange:t=>j(t.target.value),disabled:r,placeholder:"e.g., Fuji Trip 2025, Da Lat Weekend",style:{flex:1}}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r,children:r?"‚è≥ Creating...":"‚ûï Create Trip"})]})]})}),C?e.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[e.jsx("div",{style:{fontSize:"2rem"},children:"‚è≥"}),e.jsx("p",{children:"Loading trips..."})]}):b.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:"‚úàÔ∏è"}),e.jsx("p",{children:"No trips yet. Create your first trip above!"})]}):e.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:b.map(t=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem",background:t.tripId===o?"linear-gradient(135deg, #ff9ec1 0%, #ffc4e1 100%)":"white",borderRadius:"8px",border:t.tripId===o?"2px solid #ff9ec1":"2px solid var(--gray-200)",cursor:"pointer",transition:"all 0.2s"},onClick:()=>D(t.tripId),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:t.tripId===o?"‚úÖ":"‚úàÔ∏è"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"600",fontSize:"1rem",color:t.tripId===o?"white":"inherit"},children:t.tripName}),e.jsx("div",{style:{fontSize:"0.75rem",color:t.tripId===o?"rgba(255, 255, 255, 0.8)":"var(--gray-600)"},children:new Date(t.createdAt).toLocaleDateString()})]})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),E(t.tripId,t.tripName)},disabled:r,style:{padding:"0.5rem 1rem",background:"#fee2e2",color:"#991b1b",borderRadius:"6px",border:"none",fontWeight:"600",fontSize:"0.875rem",cursor:r?"not-allowed":"pointer",transition:"all 0.2s",opacity:r?.6:1},onMouseOver:s=>{r||(s.currentTarget.style.background="#fecaca")},onMouseOut:s=>{r||(s.currentTarget.style.background="#fee2e2")},children:"üóëÔ∏è Delete"})]},t.tripId))})]}),o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card",children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem",fontWeight:"700"},children:"üë• Add Payer Name"}),e.jsx("form",{onSubmit:P,children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"newName",children:"Name"}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("input",{id:"newName",type:"text",className:"form-input",value:f,onChange:t=>N(t.target.value),disabled:r,placeholder:"Enter name (e.g., Alice, Bob)",style:{flex:1}}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r,children:r?"‚è≥ Adding...":"‚ûï Add Name"})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem",fontWeight:"700"},children:["üìã Payer Names (",h.length,")"]}),h.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:"üë§"}),e.jsx("p",{children:"No payer names yet. Add some above!"})]}):e.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:h.map(t=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem",background:"var(--gray-50)",borderRadius:"8px",border:"2px solid var(--gray-200)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"1.5rem"},children:"üë§"}),e.jsx("span",{style:{fontWeight:"600",fontSize:"1rem"},children:t})]}),e.jsx("button",{onClick:()=>F(t),disabled:r,style:{padding:"0.5rem 1rem",background:"#fee2e2",color:"#991b1b",borderRadius:"6px",border:"none",fontWeight:"600",fontSize:"0.875rem",cursor:r?"not-allowed":"pointer",transition:"all 0.2s",opacity:r?.6:1},onMouseOver:s=>{r||(s.currentTarget.style.background="#fecaca")},onMouseOut:s=>{r||(s.currentTarget.style.background="#fee2e2")},children:"üóëÔ∏è Remove"})]},t))})]}),e.jsxs("div",{className:"card",style:{background:"#fef2f2",border:"2px solid #fca5a5"},children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem",fontWeight:"700",color:"#991b1b"},children:"üóëÔ∏è Danger Zone"}),e.jsx("form",{onSubmit:L,children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"deletePassword",style:{color:"#991b1b"},children:"Delete All Expenses"}),e.jsxs("p",{style:{color:"#991b1b",fontSize:"0.875rem",marginBottom:"1rem"},children:["This will permanently delete ALL expenses from Google Sheets. Type the password ",e.jsx("strong",{children:'"ok"'})," to confirm."]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("input",{id:"deletePassword",type:"text",className:"form-input",value:x,onChange:t=>w(t.target.value),disabled:c,placeholder:"Enter password",style:{flex:1}}),e.jsx("button",{type:"submit",disabled:c,style:{padding:"0.75rem 1.5rem",background:"#dc2626",color:"white",borderRadius:"8px",fontWeight:"600",fontSize:"0.875rem",border:"none",cursor:c?"not-allowed":"pointer",opacity:c?.6:1},children:c?"‚è≥ Deleting...":"üóëÔ∏è Delete All"})]})]})})]})]}),e.jsx("div",{className:"card",style:{background:"#fffbeb",border:"2px solid #fcd34d"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:"üí°"}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontWeight:"700",marginBottom:"0.5rem",color:"#78350f"},children:"Tip"}),e.jsxs("p",{style:{color:"#78350f",lineHeight:"1.6"},children:[e.jsx("strong",{children:"How to use:"}),e.jsx("br",{}),'1. Create a trip above (e.g., "Fuji Trip 2025")',e.jsx("br",{}),"2. Add all trip members as payer names",e.jsx("br",{}),"3. Go to Home page to add expenses",e.jsx("br",{}),e.jsx("br",{}),"Each trip has its own expenses and payer names. Switch between trips by clicking them above!"]})]})]})})]})}export{J as default};
